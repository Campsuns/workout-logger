/* ===============================================================
   Workout Logger — UI polish + data-scoped themes
   =============================================================== */

/* ---- Base palette & theme ---- */
:root{
  --bg:#0b0b0c;
  --fg:#ffffff;
  --muted:#a0a0a8;
  --soft:#15161b;
  --card:#111216;
  --line:#23242b;
  --glass: rgba(10,11,15,0.62);
  --glass-bd:#1d1e25;

  --accent:#2bd2c8;  --accent-r:45; --accent-g:212; --accent-b:191;
  --accent-weak: rgba(43,210,200,0.20);

  --chip-h:40px; --chip-px:14px; --radius:12px;
}
body.annie{
  --accent:#c9a7ff;  --accent-r:201; --accent-g:167; --accent-b:255;
  --accent-weak: rgba(201,167,255,0.22);
}

/* Resets */
*{ box-sizing:border-box; }
html,body{ margin:0; padding:0; background:var(--bg); color:var(--fg);
  font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
}

/* Flash */
#flash{ position:fixed; inset:0; background:rgba(var(--accent-r),var(--accent-g),var(--accent-b),.35); opacity:0; pointer-events:none; }
#flash.show{ animation: flash 650ms ease-in-out; }
@keyframes flash{ 0%{opacity:0;} 20%{opacity:.22;} 100%{opacity:0;} }

/* USER BAR */
.user-bar{
  padding: calc(env(safe-area-inset-top) + 12px) 16px 10px;
  display:grid; grid-template-columns:1fr 1fr; gap:12px; width:100%;
}
.user-chip{
  height:var(--chip-h); padding:0 var(--chip-px); width:100%;
  background:var(--soft); color:var(--fg);
  border:1px solid var(--line); border-radius:var(--radius);
  display:inline-flex; align-items:center; justify-content:center;
  font-weight:800; font-size:13px;
}
.user-chip.active{
  border-color:var(--accent);
  box-shadow:inset 0 0 0 2px var(--accent-weak);
}

/* HEADER (frosted + feather) */
.topbar{
  display:grid; grid-template-columns:1fr 1fr; align-items:center; column-gap:12px;
  position:sticky; top:0; z-index:50;
  padding:6px 16px 10px;
  background:var(--glass);
  border-bottom:1px solid var(--glass-bd);
  backdrop-filter:saturate(120%) blur(13px);
  -webkit-backdrop-filter:saturate(120%) blur(13px);
}
.topbar::after{
  content:""; position:absolute; left:0; right:0; bottom:-22px; height:22px;
  background:linear-gradient(var(--glass), rgba(0,0,0,0));
  pointer-events:none;
}
.topbar .brand{
  grid-column:1/2;
  font-weight:700; letter-spacing:.25px; font-size:18px;
  transform: translateY(-2px);
}

/* NAV (Workouts/Summary) — dashed chips to match +New/Reset */
.nav-tabs{
  grid-column:2/3;
  display:grid; grid-template-columns:1fr 1fr; gap:12px;
}
.nav-tabs button{
  height:var(--chip-h); padding:0 var(--chip-px); width:100%;
  background:var(--soft); color:var(--fg);
  border:1px dashed var(--line); border-radius:var(--radius);
  font-weight:700; font-size:13px;
}
.nav-tabs button.active{
  border-color:var(--accent);
  box-shadow:inset 0 0 0 2px var(--accent-weak);
  background:transparent; color:var(--fg);
}

/* FILTER BAR */
.filters{
  position:sticky; top:56px; z-index:40;
  padding:10px 16px 12px;
  background:var(--glass);
  border-bottom:1px solid var(--glass-bd);
  backdrop-filter:saturate(120%) blur(11px);
  -webkit-backdrop-filter:saturate(120%) blur(11px);
  display:grid; grid-template-columns:1fr 1fr; gap:12px;
}
.filters::after{
  content:""; position:absolute; left:0; right:0; bottom:-24px; height:24px;
  background:linear-gradient(var(--glass), rgba(0,0,0,0)); pointer-events:none;
}
.filters .btnrow{ display:grid; grid-template-columns:1fr 1fr; gap:12px; }

/* Selects same size as +New/Reset (not bold) */
select, input, button, textarea{ font:inherit; }
.filters select{
  width:100%; height:var(--chip-h); padding:0 12px;
  background:#15161b; color:#fff; border:1px solid var(--line);
  border-radius:var(--radius); font-size:13px; font-weight:500;
  display:inline-flex; align-items:center;
}
button{ cursor:pointer; }
button.ghost{
  background:#15161b; color:#e6e6e6;
  border:1px dashed var(--line); border-radius:var(--radius);
  height:var(--chip-h); padding:0 var(--chip-px);
  font-weight:700; font-size:13px;
}
#btnAddExercise, #btnResetDone{ width:100%; }

/* PADDING AROUND CONTENT (breathing room) */
.page, .split-wrap, .summary{ padding: 0 16px 16px; }

/* CARDS */
.cards{ display:grid; grid-template-columns:1fr; gap:10px; }
.card{
  background:var(--card); border:1px solid #191a20; border-radius:16px;
  padding:12px; display:grid; grid-template-columns:1fr auto; gap:8px; align-items:center;
}
.card:hover{ border-color:#2a2b32; }
.card .left{ display:flex; flex-direction:column; gap:3px; min-width:0; }
.name-line{ display:flex; align-items:baseline; gap:6px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.name{ font-weight:700; } /* match nav weight */
.variation{ font-size:13px; color:#aeb0b9; font-weight:600; }
.line.meta{ color:#aeb0b9; font-size:13px; }
.line.weight{ color:#e8e9ef; font-size:14px; font-weight:700; }

.pill.repsets{
  display:inline-flex; align-items:center; justify-content:center;
  background:transparent; color:#cfcfd6;
  border:1px solid var(--accent); border-radius:999px;
  min-width:98px; padding:8px 12px; white-space:nowrap; font-variant-numeric:tabular-nums;
}
.card.done{ border-color:#21443f; box-shadow:0 0 0 1px #21443f inset; }
.card.done .repsets{ border-color:#1f5d55; color:#b6fff2; }

/* DIALOGS (log + add) */
dialog{ width:100%; max-width:520px; border:none; border-radius:20px; padding:0; background:#0d0e12; color:#fff; }
dialog::backdrop{ background:rgba(0,0,0,.6); backdrop-filter: blur(4px); }
.logform{ padding:16px; }
.stack{ display:flex; flex-direction:column; gap:10px; }
.stepper{ background:#0f1015; border:1px solid #1f2028; border-radius:16px; padding:10px; text-align:center; }
.stepper label{ display:block; font-weight:700; font-size:12px; color:#c7c7d0; letter-spacing:.4px; }
.stepper .ctr{ margin-top:6px; display:flex; align-items:center; justify-content:space-between; gap:8px; }
.stepper .ctr button{ width:44px; height:44px; border-radius:12px; background:#15161b; border:1px solid #23242b; color:#fff; }
.stepper .ctr span{ font-size:28px; font-weight:800; letter-spacing:1px; display:inline-block; width:96px; text-align:center; }
.seg{ display:flex; align-items:center; justify-content:space-between; background:#0f1015; border:1px solid #1f2028; border-radius:16px; padding:10px; }
.seg span{ color:#c7c7d0; font-weight:700; font-size:12px; }
.seg-buttons{ display:flex; gap:6px; }
.seg-buttons button{ background:#15161b; border:1px solid #23242b; color:#fff; padding:8px 10px; border-radius:10px; }
.seg-buttons button.active{ border-color:var(--accent); box-shadow: inset 0 0 0 2px var(--accent-weak); background:transparent; color:#e6fff9; }
textarea{ width:100%; min-height:72px; background:#0f1015; border:1px solid #1f2028; border-radius:14px; padding:10px; color:#fff; }

menu{ display:flex; gap:12px; justify-content:flex-end; margin:12px 0 0; padding:0; }
menu .sp{ flex:1; }
menu button{ height:var(--chip-h); padding:0 var(--chip-px); border-radius:var(--radius); border:1px dashed var(--line); background:#15161b; color:#fff; font-weight:700; }
#btnLog{ background:var(--accent); border:1px solid var(--accent); color:#062822; font-weight:800; }

/* SUMMARY period tabs */
.period-tabs{ display:grid; grid-template-columns:repeat(3,1fr); gap:8px; padding:8px 16px; position:sticky; top:56px; }
.period-tabs button{
  height:var(--chip-h); padding:0 var(--chip-px);
  background:var(--soft); color:var(--fg);
  border:1px dashed var(--line); border-radius:var(--radius);
  font-weight:700; font-size:13px;
}
.period-tabs button.active{ border-color:var(--accent); box-shadow:inset 0 0 0 2px var(--accent-weak); background:transparent; }

/* MISC */
.group-title{ color:#c7c7d0; font-size:12px; letter-spacing:.2px; margin:14px 0 8px; padding: 0 16px; }
.subgroup{ margin-bottom:12px; }
.filters select, .filters button, #btnAddExercise, #btnResetDone, .user-chip, .nav-tabs button, .period-tabs button{
  display:inline-flex; align-items:center; justify-content:center; transform: translateY(-2px);
}
.stepper .ctr button, .period-tabs button, .filters button{ touch-action: manipulation; -webkit-user-select: none; user-select: none; }


/* PAGE visibility */
.page{ display:none; }
.page.active{ display:block; }

/* Hide filters when on summary page */
body[data-page="summary"] .filters{ display:none; }


/* Hide split sections when viewing Summary */
body[data-page="summary"] #selectedSplitWrap,
body[data-page="summary"] #otherTitle { display: none !important; }


/* ---- Optimistic & Stepper Pulse ---- */
:root{ --danger:#ff5b6b; --danger-r:255; --danger-g:91; --danger-b:107; }

@keyframes pulseUp {
  0%   { box-shadow: 0 0 0 0 rgba(var(--accent-r),var(--accent-g),var(--accent-b), .35); }
  100% { box-shadow: 0 0 0 14px rgba(var(--accent-r),var(--accent-g),var(--accent-b), 0); }
}
@keyframes pulseDown {
  0%   { box-shadow: 0 0 0 0 rgba(var(--danger-r),var(--danger-g),var(--danger-b), .35); }
  100% { box-shadow: 0 0 0 14px rgba(var(--danger-r),var(--danger-g),var(--danger-b), 0); }
}
.stepper{ position:relative; overflow:visible; }
.stepper.pulse-up   { border-color: var(--accent); animation: pulseUp .38s ease-out; }
.stepper.pulse-down { border-color: var(--danger); animation: pulseDown .38s ease-out; }


/* ---- v10: tame iOS blue focus ring & use accent ring ---- */
button:focus { outline: none !important; }
button:focus-visible { outline: none !important; }

/* More specific for our controls */
.seg-buttons button:focus-visible,
.stepper .ctr button:focus-visible,
.nav-tabs button:focus-visible,
.user-chip:focus-visible,
.period-tabs button:focus-visible,
button.ghost:focus-visible {
  border-color: var(--accent) !important;
  box-shadow: inset 0 0 0 2px var(--accent-weak), 0 0 0 2px rgba(0,0,0,0) !important;
}
